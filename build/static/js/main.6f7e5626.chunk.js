(this["webpackJsonpbloglist-frontend"]=this["webpackJsonpbloglist-frontend"]||[]).push([[0],{68:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n.n(r),c=n(21),s=n.n(c),o=n(15),u=n(2),i=n.n(u),l=n(3),d=n(10),b=n(13),j=n(0),p=function(e){var t=e.type,n=e.onClick,r=e.children;return Object(j.jsx)("button",{type:t,onClick:n,class:"btn btn-outline-warning",children:r})},f=n(14),h=function(e){var t=e.blog,n=(e.updateLike,e.removeBlog,e.usercheck,Object(r.useState)(!1)),a=Object(b.a)(n,2);a[0],a[1];return Object(j.jsx)("main",{children:Object(j.jsx)("div",{children:Object(j.jsx)(f.b,{to:"/blogs/".concat(t.id),class:"btn btn-primary",children:t.title})})})},O=n(11),v=n.n(O),x="/api/blogs",g=null,m={getAll:function(){var e=Object(l.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.a.get(x);case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),create:function(){var e=Object(l.a)(i.a.mark((function e(t){var n,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:g}},e.next=3,v.a.post(x,t,n);case 3:return r=e.sent,console.log(r.data),e.abrupt("return",r.data);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),update:function(){var e=Object(l.a)(i.a.mark((function e(t,n){var r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.a.put("".concat(x,"/").concat(t),n);case 2:return r=e.sent,e.abrupt("return",r.data);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),setToken:function(e){g="bearer ".concat(e)},remove:function(){var e=Object(l.a)(i.a.mark((function e(t){var n,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:g}},e.next=3,v.a.delete("".concat(x,"/").concat(t),n);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},w={login:function(){var e=Object(l.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},y={getUsers:function(){var e=Object(l.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.a.get("/api/users");case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},k=n(17),E=function(e){var t=e.label,n=e.type,r=e.value,a=e.onChange,c=e.name,s=e.htmlFor;e.id;return Object(j.jsxs)("div",{class:"form-floating mb-3",children:[Object(j.jsx)("label",{htmlFor:s,children:t}),Object(j.jsx)("input",{id:t,type:n,name:c,value:r,onChange:a,class:"form-control"})]})},S=function(e){var t=e.handleLogin,n=Object(r.useState)(null),a=Object(b.a)(n,2),c=a[0],s=a[1],o=function(e){var t=e.target,n=t.value,r=t.name;s((function(e){return Object(d.a)(Object(d.a)({},e),{},Object(k.a)({},r,n))}))};return Object(j.jsxs)("form",{onSubmit:function(e){e.preventDefault();var n=null===c||void 0===c?void 0:c.username,r=null===c||void 0===c?void 0:c.password;try{t(n,r),s({username:"",password:""})}catch(a){console.error(a)}},children:[Object(j.jsx)(E,{label:"Username",type:"text",name:"username",value:(null===c||void 0===c?void 0:c.username)||"",onChange:o}),Object(j.jsx)(E,{label:"Password",type:"text",name:"password",value:(null===c||void 0===c?void 0:c.password)||"",onChange:o}),Object(j.jsx)(p,{type:"submit",children:"Login"})]})},C=function(e){var t=e.createBlog,n=Object(r.useState)(null),a=Object(b.a)(n,2),c=a[0],s=a[1],o=function(e){var t=e.target,n=t.value,r=t.name;s((function(e){return Object(d.a)(Object(d.a)({},e),{},Object(k.a)({},r,n))}))};return Object(j.jsxs)("form",{onSubmit:function(e){e.preventDefault();try{var n={title:null===c||void 0===c?void 0:c.title,author:null===c||void 0===c?void 0:c.author,url:null===c||void 0===c?void 0:c.url};console.log(n),t(n),s({author:"",title:"",url:""})}catch(r){console.error(r)}},class:"mb-3",children:[Object(j.jsx)(E,{type:"text",name:"title",label:"title",htmlFor:"title",value:(null===c||void 0===c?void 0:c.title)||"",onChange:o}),Object(j.jsx)(E,{type:"text",name:"author",label:"author",htmlFor:"author",value:(null===c||void 0===c?void 0:c.author)||"",onChange:o}),Object(j.jsx)(E,{type:"text",name:"url",label:"url",htmlFor:"url",value:(null===c||void 0===c?void 0:c.url)||"",onChange:o}),Object(j.jsx)(p,{type:"submit",children:"Create"})]})},L=a.a.forwardRef((function(e,t){var n=e.btnText,a=e.children,c=Object(r.useState)(!1),s=Object(b.a)(c,2),o=s[0],u=s[1],i={display:o?"none":""},l={display:o?"":"none"},d=function(){u(!o)};return Object(r.useImperativeHandle)(t,(function(){return{toggleVisibility:d}})),Object(j.jsxs)("div",{className:"newblog",children:[Object(j.jsx)(p,{style:i,type:"button",onClick:d,children:n}),Object(j.jsxs)("div",{style:l,children:[a,Object(j.jsx)(p,{type:"button",onClick:d,children:"cancel"})]})]})}));L.displayName="Togglable";var B=L,T="/api/comments",I={addComment:function(){var e=Object(l.a)(i.a.mark((function e(t,n){var r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.a.post("".concat(T,"/").concat(t),n);case 2:return r=e.sent,e.abrupt("return",r.data);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),fetchComment:function(){var e=Object(l.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.a.get("".concat(T,"/").concat(t));case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},F=function(e){var t=e.blogdetail,n=e.addLike,a=Object(r.useState)(null),c=Object(b.a)(a,2),s=c[0],o=c[1],u=Object(r.useState)(null),p=Object(b.a)(u,2),f=p[0],h=p[1];Object(r.useEffect)((function(){function e(){return(e=Object(l.a)(i.a.mark((function e(){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I.fetchComment(t.id);case 2:n=e.sent,console.log(n),h(n);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]);return Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)("h2",{class:"fst-italic",children:t.title}),Object(j.jsx)("span",{class:"lh-base",children:t.url}),Object(j.jsx)("br",{}),Object(j.jsxs)("span",{class:"text-start",children:[t.likes," likes"]}),Object(j.jsx)("button",{type:"button",onClick:function(){var e=Object(d.a)(Object(d.a)({},t),{},{likes:t.likes+1});n(t.id,e)},class:"btn btn-dark",children:"like"}),Object(j.jsx)("br",{}),Object(j.jsxs)("span",{class:"text-decoration-underline",children:["added by ",t.author]}),Object(j.jsx)("br",{}),Object(j.jsx)("h3",{class:"fw-normal",children:"comments"}),Object(j.jsx)("br",{}),Object(j.jsxs)("form",{onSubmit:function(e){e.preventDefault();try{I.addComment(t.id,s),o(null)}catch(n){console.error(n)}},children:[Object(j.jsx)("input",{type:"text",onChange:function(e){var t={content:e.target.value};o(t),console.log(t)},name:"comment",class:"form-control","aria-describedby":"addon-wrapping"}),Object(j.jsx)("button",{type:"submit",class:"btn btn-primary btn-lg",children:"add comment"})]}),Object(j.jsx)("br",{}),f?f.map((function(e){return Object(j.jsx)("li",{class:"list-group-item",children:e.content},e.id)})):null]})},G=function(e,t){return function(){var n=Object(l.a)(i.a.mark((function n(r){return i.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:r({type:"SET_MESSAGE",data:{message:e,delay:setTimeout((function(){r(N(""))}),1e3*t)}});case 1:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()},N=function(){return{type:"REMOVE_MESSAGE"}},_=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;switch(console.log("state: ",e),console.log("action",t),t.type){case"SET_MESSAGE":return clearTimeout(e.delay),t.data;case"REMOVE_MESSAGE":return"";default:return e}},A=n(28),M=function(e,t){return function(){var n=Object(l.a)(i.a.mark((function n(r){var a;return i.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,m.update(e,t);case 2:a=n.sent,r({type:"LIKE_BLOG",data:a});case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()},U=function(e){return function(){var t=Object(l.a)(i.a.mark((function t(n){var r;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,m.remove(e);case 2:return t.next=4,m.getAll();case 4:r=t.sent,n({type:"INIT_BLOG",data:r});case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},D=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(console.log("state now: ",e),console.log("action",t),t.type){case"INIT_BLOG":return t.data;case"NEW_BLOG":case"LIKE_BLOG":return[].concat(Object(A.a)(e),[t.data]);default:return e}},R=function(e){return function(){var t=Object(l.a)(i.a.mark((function t(n){var r;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,w.login(e);case 2:r=t.sent,n({type:"LOGIN",data:r});case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},W=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOGIN":return t.data;default:return e}},H=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"FETCH":return t.data;default:return e}},J=function(){var e=Object(o.c)((function(e){return e.notification}));return Object(j.jsx)(j.Fragment,{children:Object(j.jsx)("div",{children:e})})},V=n(5),z=function(e){var t=e.users;return Object(j.jsx)(j.Fragment,{children:t.map((function(e){return Object(j.jsx)(j.Fragment,{children:Object(j.jsxs)("tr",{children:[Object(j.jsx)("td",{children:Object(j.jsx)(f.b,{to:"/users/".concat(e.id),children:e.name},e.id)}),Object(j.jsx)("td",{children:e.blogs.length})]})})}))})},K=function(e){var t=e.userBlog;return Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)("h2",{class:"display-2",children:t.name}),Object(j.jsx)("p",{class:"fw-bolder",children:"added blogs"}),t.blogs.map((function(e){return Object(j.jsx)("li",{children:Object(j.jsx)(f.b,{to:"/blogs/".concat(e.id),class:"stretched-link",children:e.title})},e.id)}))]})},P=function(){var e=Object(o.b)(),t=a.a.createRef(),n=Object(o.c)((function(e){return e.user})),c=Object(o.c)((function(e){return e.users})),s=function(){var t=Object(l.a)(i.a.mark((function t(r,a){return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e(R({username:r,password:a})),e(function(){var e=Object(l.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.getUsers();case 2:n=e.sent,t({type:"FETCH",data:n});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),window.localStorage.setItem("loggedBlogappUser",JSON.stringify(n)),t.next=6,m.setToken(n.token);case 6:t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),G("Wrong credentials",5);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e,n){return t.apply(this,arguments)}}();Object(r.useEffect)((function(){window.localStorage.getItem("loggedBlogappUser")}),[]),Object(r.useEffect)((function(){e(function(){var e=Object(l.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.getAll();case 2:n=e.sent,t({type:"INIT_BLOG",data:n});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[]);var u=Object(o.c)((function(e){return e.blog}));console.log(u);var d=function(){var e=Object(l.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),window.localStorage.removeItem("loggedBlogappUser"),m.setToken("");case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),b=function(){var t=Object(l.a)(i.a.mark((function t(n,r){return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e(M(n,r));case 3:G("liked",5),t.next=9;break;case 6:t.prev=6,t.t0=t.catch(0),G("no",5);case 9:case"end":return t.stop()}}),t,null,[[0,6]])})));return function(e,n){return t.apply(this,arguments)}}(),p=function(){var t=Object(l.a)(i.a.mark((function t(n){return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!window.confirm("remove?")){t.next=4;break}return t.next=4,e(U(n));case 4:G("remove successfully",5),t.next=11;break;case 7:t.prev=7,t.t0=t.catch(0),console.error(t.t0),G("no!",5);case 11:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}(),f=Object(V.f)("/users/:id"),O=f?c.find((function(e){return e.id===f.params.id})):null,v=Object(V.f)("/blogs/:id"),x=v?u.find((function(e){return e.id===v.params.id})):null;return null===n?Object(j.jsxs)("main",{children:[Object(j.jsx)("div",{children:Object(j.jsx)("h2",{children:"Log in to application"})}),Object(j.jsx)(J,{}),Object(j.jsx)(S,{handleLogin:s})]}):Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)("nav",{class:"navbar navbar-expand-lg navbar-light bg-light",children:Object(j.jsxs)("div",{class:"container-fluid",children:[Object(j.jsx)("a",{class:"navbar-brand",href:"/blogs",children:"blogs"}),Object(j.jsx)("a",{class:"navbar-brand",href:"/users",children:"users"}),Object(j.jsxs)("span",{children:[n.name," logged in",Object(j.jsx)("button",{class:"navbar-toggler",onClick:d,children:"logout"})]})]})}),Object(j.jsx)("div",{children:Object(j.jsx)("h2",{class:"text-center",children:"blogs"})}),Object(j.jsx)(J,{}),Object(j.jsxs)(V.c,{children:[Object(j.jsxs)(V.a,{exact:!0,path:"/",children:[Object(j.jsx)("div",{children:Object(j.jsx)("h2",{class:"badge bg-primary text-wrap",children:"Users"})}),Object(j.jsx)("table",{class:"table",children:Object(j.jsxs)("tbody",{children:[Object(j.jsxs)("tr",{children:[Object(j.jsx)("th",{}),Object(j.jsx)("th",{scope:"col",children:"blogs created"})]}),Object(j.jsx)(z,{users:c})]})}),Object(j.jsxs)("div",{children:[Object(j.jsx)("h2",{class:"text-sm-start",children:"create new"}),Object(j.jsx)(B,{btnText:"New Blog",ref:t,children:Object(j.jsx)(C,{createBlog:function(t){e(function(e){return function(){var t=Object(l.a)(i.a.mark((function t(n){var r;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,m.create(e);case 2:r=t.sent,n({type:"NEW_BLOG",data:r});case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}(t)),G("A new blog added",5)}})})]}),u.sort((function(e,t){return t.likes-e.likes})).map((function(e){return Object(j.jsx)(h,{blog:e,updateLike:b,removeBlog:p,usercheck:n.username},e.id)}))]}),Object(j.jsx)(V.a,{path:"/users/:id",children:Object(j.jsx)(K,{userBlog:O})}),Object(j.jsx)(V.a,{path:"/blogs/:id",children:Object(j.jsx)(F,{blogdetail:x,addLike:b})})]})]})},q=n(20),Q=n(37),X=n(38),Y=Object(q.combineReducers)({notification:_,blog:D,user:W,users:H}),Z=Object(q.createStore)(Y,Object(X.composeWithDevTools)(Object(q.applyMiddleware)(Q.a)));s.a.render(Object(j.jsx)(f.a,{children:Object(j.jsx)(o.a,{store:Z,children:Object(j.jsx)(P,{})})}),document.getElementById("root"))}},[[68,1,2]]]);
//# sourceMappingURL=main.6f7e5626.chunk.js.map